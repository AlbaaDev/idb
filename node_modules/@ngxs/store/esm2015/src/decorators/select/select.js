/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ɵivyEnabled } from '@angular/core';
import { mergeMap } from 'rxjs/operators';
import { localInject, ensureLocalInjectorCaptured, ensureInjectorNotifierIsCaptured } from '@ngxs/store/internals';
import { Store } from '../../store';
import { NgxsConfig } from '../../symbols';
import { createSelectObservable, createSelectorFn } from './symbols';
/**
 * Decorator for selecting a slice of state from the store.
 * @template T
 * @param {?=} rawSelector
 * @param {...?} paths
 * @return {?}
 */
export function Select(rawSelector, ...paths) {
    return (/**
     * @param {?} target
     * @param {?} key
     * @return {?}
     */
    function (target, key) {
        /** @type {?} */
        const name = key.toString();
        /** @type {?} */
        const selectorId = `__${name}__selector`;
        /** @type {?} */
        let selector = null;
        /** @type {?} */
        let injectorNotifier$ = null;
        if (ɵivyEnabled) {
            injectorNotifier$ = ensureInjectorNotifierIsCaptured(target);
        }
        Object.defineProperties(target, {
            [selectorId]: {
                writable: true,
                enumerable: false,
                configurable: true
            },
            [name]: {
                enumerable: true,
                configurable: true,
                /**
                 * @return {?}
                 */
                get() {
                    if (this[selectorId]) {
                        return this[selectorId];
                    }
                    // The `localInject` will be tree-shaken away in apps that
                    // still use the View Engine.
                    if (ɵivyEnabled) {
                        this[selectorId] = (/** @type {?} */ (injectorNotifier$)).pipe(mergeMap((/**
                         * @return {?}
                         */
                        () => {
                            /** @type {?} */
                            const store = localInject(this, Store);
                            /** @type {?} */
                            const config = localInject(this, NgxsConfig);
                            selector = selector || createSelectorFn(config, name, rawSelector, paths);
                            return createSelectObservable(selector, store);
                        })));
                    }
                    else {
                        selector = selector || createSelectorFn(null, name, rawSelector, paths);
                        this[selectorId] = createSelectObservable(selector, null);
                    }
                    return this[selectorId];
                }
            }
        });
        // Keep this `if` guard here so the below stuff will be tree-shaken away in apps that still use the View Engine.
        if (ɵivyEnabled) {
            ensureLocalInjectorCaptured(target);
        }
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VsZWN0LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQG5neHMvc3RvcmUvIiwic291cmNlcyI6WyJzcmMvZGVjb3JhdG9ycy9zZWxlY3Qvc2VsZWN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRTVDLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUMxQyxPQUFPLEVBQ0wsV0FBVyxFQUNYLDJCQUEyQixFQUMzQixnQ0FBZ0MsRUFDakMsTUFBTSx1QkFBdUIsQ0FBQztBQUUvQixPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sYUFBYSxDQUFDO0FBQ3BDLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFFLHNCQUFzQixFQUFFLGdCQUFnQixFQUFjLE1BQU0sV0FBVyxDQUFDOzs7Ozs7OztBQUtqRixNQUFNLFVBQVUsTUFBTSxDQUFJLFdBQWUsRUFBRSxHQUFHLEtBQWU7SUFDM0Q7Ozs7O0lBQU8sVUFBUyxNQUFNLEVBQUUsR0FBRzs7Y0FDbkIsSUFBSSxHQUFXLEdBQUcsQ0FBQyxRQUFRLEVBQUU7O2NBQzdCLFVBQVUsR0FBRyxLQUFLLElBQUksWUFBWTs7WUFDcEMsUUFBUSxHQUFzQixJQUFJOztZQUNsQyxpQkFBaUIsR0FBa0MsSUFBSTtRQUUzRCxJQUFJLFdBQVcsRUFBRTtZQUNmLGlCQUFpQixHQUFHLGdDQUFnQyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1NBQzlEO1FBRUQsTUFBTSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sRUFBRTtZQUM5QixDQUFDLFVBQVUsQ0FBQyxFQUFFO2dCQUNaLFFBQVEsRUFBRSxJQUFJO2dCQUNkLFVBQVUsRUFBRSxLQUFLO2dCQUNqQixZQUFZLEVBQUUsSUFBSTthQUNuQjtZQUNELENBQUMsSUFBSSxDQUFDLEVBQUU7Z0JBQ04sVUFBVSxFQUFFLElBQUk7Z0JBQ2hCLFlBQVksRUFBRSxJQUFJOzs7O2dCQUNsQixHQUFHO29CQUNELElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxFQUFFO3dCQUNwQixPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztxQkFDekI7b0JBQ0QsMERBQTBEO29CQUMxRCw2QkFBNkI7b0JBQzdCLElBQUksV0FBVyxFQUFFO3dCQUNmLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxtQkFBQSxpQkFBaUIsRUFBQyxDQUFDLElBQUksQ0FDeEMsUUFBUTs7O3dCQUFDLEdBQUcsRUFBRTs7a0NBQ04sS0FBSyxHQUFHLFdBQVcsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDOztrQ0FDaEMsTUFBTSxHQUFHLFdBQVcsQ0FBQyxJQUFJLEVBQUUsVUFBVSxDQUFDOzRCQUM1QyxRQUFRLEdBQUcsUUFBUSxJQUFJLGdCQUFnQixDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFLEtBQUssQ0FBQyxDQUFDOzRCQUMxRSxPQUFPLHNCQUFzQixDQUFDLFFBQVEsRUFBRSxLQUFLLENBQUMsQ0FBQzt3QkFDakQsQ0FBQyxFQUFDLENBQ0gsQ0FBQztxQkFDSDt5QkFBTTt3QkFDTCxRQUFRLEdBQUcsUUFBUSxJQUFJLGdCQUFnQixDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFLEtBQUssQ0FBQyxDQUFDO3dCQUN4RSxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsc0JBQXNCLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFDO3FCQUMzRDtvQkFDRCxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztnQkFDMUIsQ0FBQzthQUNGO1NBQ0YsQ0FBQyxDQUFDO1FBRUgsZ0hBQWdIO1FBQ2hILElBQUksV0FBVyxFQUFFO1lBQ2YsMkJBQTJCLENBQUMsTUFBTSxDQUFDLENBQUM7U0FDckM7SUFDSCxDQUFDLEVBQUM7QUFDSixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgybVpdnlFbmFibGVkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBSZXBsYXlTdWJqZWN0IH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBtZXJnZU1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7XG4gIGxvY2FsSW5qZWN0LFxuICBlbnN1cmVMb2NhbEluamVjdG9yQ2FwdHVyZWQsXG4gIGVuc3VyZUluamVjdG9yTm90aWZpZXJJc0NhcHR1cmVkXG59IGZyb20gJ0BuZ3hzL3N0b3JlL2ludGVybmFscyc7XG5cbmltcG9ydCB7IFN0b3JlIH0gZnJvbSAnLi4vLi4vc3RvcmUnO1xuaW1wb3J0IHsgTmd4c0NvbmZpZyB9IGZyb20gJy4uLy4uL3N5bWJvbHMnO1xuaW1wb3J0IHsgY3JlYXRlU2VsZWN0T2JzZXJ2YWJsZSwgY3JlYXRlU2VsZWN0b3JGbiwgU2VsZWN0b3JGbiB9IGZyb20gJy4vc3ltYm9scyc7XG5cbi8qKlxuICogRGVjb3JhdG9yIGZvciBzZWxlY3RpbmcgYSBzbGljZSBvZiBzdGF0ZSBmcm9tIHRoZSBzdG9yZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIFNlbGVjdDxUPihyYXdTZWxlY3Rvcj86IFQsIC4uLnBhdGhzOiBzdHJpbmdbXSk6IFByb3BlcnR5RGVjb3JhdG9yIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHRhcmdldCwga2V5KTogdm9pZCB7XG4gICAgY29uc3QgbmFtZTogc3RyaW5nID0ga2V5LnRvU3RyaW5nKCk7XG4gICAgY29uc3Qgc2VsZWN0b3JJZCA9IGBfXyR7bmFtZX1fX3NlbGVjdG9yYDtcbiAgICBsZXQgc2VsZWN0b3I6IFNlbGVjdG9yRm4gfCBudWxsID0gbnVsbDtcbiAgICBsZXQgaW5qZWN0b3JOb3RpZmllciQ6IFJlcGxheVN1YmplY3Q8Ym9vbGVhbj4gfCBudWxsID0gbnVsbDtcblxuICAgIGlmICjJtWl2eUVuYWJsZWQpIHtcbiAgICAgIGluamVjdG9yTm90aWZpZXIkID0gZW5zdXJlSW5qZWN0b3JOb3RpZmllcklzQ2FwdHVyZWQodGFyZ2V0KTtcbiAgICB9XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHtcbiAgICAgIFtzZWxlY3RvcklkXToge1xuICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSxcbiAgICAgIFtuYW1lXToge1xuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgIGdldCgpIHtcbiAgICAgICAgICBpZiAodGhpc1tzZWxlY3RvcklkXSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXNbc2VsZWN0b3JJZF07XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIFRoZSBgbG9jYWxJbmplY3RgIHdpbGwgYmUgdHJlZS1zaGFrZW4gYXdheSBpbiBhcHBzIHRoYXRcbiAgICAgICAgICAvLyBzdGlsbCB1c2UgdGhlIFZpZXcgRW5naW5lLlxuICAgICAgICAgIGlmICjJtWl2eUVuYWJsZWQpIHtcbiAgICAgICAgICAgIHRoaXNbc2VsZWN0b3JJZF0gPSBpbmplY3Rvck5vdGlmaWVyJCEucGlwZShcbiAgICAgICAgICAgICAgbWVyZ2VNYXAoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHN0b3JlID0gbG9jYWxJbmplY3QodGhpcywgU3RvcmUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IGxvY2FsSW5qZWN0KHRoaXMsIE5neHNDb25maWcpO1xuICAgICAgICAgICAgICAgIHNlbGVjdG9yID0gc2VsZWN0b3IgfHwgY3JlYXRlU2VsZWN0b3JGbihjb25maWcsIG5hbWUsIHJhd1NlbGVjdG9yLCBwYXRocyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZVNlbGVjdE9ic2VydmFibGUoc2VsZWN0b3IsIHN0b3JlKTtcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNlbGVjdG9yID0gc2VsZWN0b3IgfHwgY3JlYXRlU2VsZWN0b3JGbihudWxsLCBuYW1lLCByYXdTZWxlY3RvciwgcGF0aHMpO1xuICAgICAgICAgICAgdGhpc1tzZWxlY3RvcklkXSA9IGNyZWF0ZVNlbGVjdE9ic2VydmFibGUoc2VsZWN0b3IsIG51bGwpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdGhpc1tzZWxlY3RvcklkXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gS2VlcCB0aGlzIGBpZmAgZ3VhcmQgaGVyZSBzbyB0aGUgYmVsb3cgc3R1ZmYgd2lsbCBiZSB0cmVlLXNoYWtlbiBhd2F5IGluIGFwcHMgdGhhdCBzdGlsbCB1c2UgdGhlIFZpZXcgRW5naW5lLlxuICAgIGlmICjJtWl2eUVuYWJsZWQpIHtcbiAgICAgIGVuc3VyZUxvY2FsSW5qZWN0b3JDYXB0dXJlZCh0YXJnZXQpO1xuICAgIH1cbiAgfTtcbn1cbiJdfQ==